Install steps

Required standard packages
==========================

Required packages
=================

	tlmp
	tlmpsql
	tlmpweb tlmpweb-sql
	trlitool
	bolixo
	blackhole blackhole-horizon blackhole-conproxy blackhole-misc

Modifications
=============

Remove the nat from /etc/libvirt/qemu/networks/default.xml. Without doing that, firewalld is
required and assume that all containers may go to the internet.

To run the whole thing inside an LXC container (containers in a container), you
must make /sys rw. libvirtd will fail to setup virbr0 otherwise.

Setup
=====

	Copy/configure /usr/share/bolixo/bolixo.conf -> /root/bolixo.conf

	if /root/stracelogs is empty
		bolixo-production make-httpd-log
		bolixo-production make-mysql-log
		bolixo-production make-exim-log

	bolixo-production install-sequence

	Install your certificate
	This installs a letsencrypt free (but valid) certificate
	bolixo-production certificate-install
	(
		if localhost.crt is missing, no idea why
		openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/pki/tls/private/localhost.key -out /etc/ssl/certs/localhost.crt
	)

	bolixo-production restart webs
	bolixo-production restart exim
	bolixo-production mon-sendmail
	bolixo-production writed-sendmail

	# Now that the node works in HTTPS, register to the directory bolixo.org
	bolixo-production install-sequence-post

	bolixo-production secrets
	edit/configure /root/data/manager.conf
	edit/configure /root/.bofs.conf
	# Generate configuration for all containers and rules for blackhole
	bolixo-production config
	bolixo-production blackhole-start
	# Generate containers file content
	bolixo-production lxc0s
	/root/bolixostart.sh
	bolixo-production createsqluser
	bolixo-production createdb

    and now, the following test should be all clear, almost, except for the syslog line

	bolixo-production test-system

    The services are running, the database is created. Now we complete the setup 

	# Generate the private/public key of the system
	bolixo-production generate-system-pubkey
	# Register this node into the directory server (bolixo.org)
	bolixo-production registernode
	# Create the admin acccount
	bolixo-production createadmin

    we can review the log, but most errors are normal during setup, so we reset everything

	bolixo-production syslog-clear
	bolixo-production syslog-reset

    and now, the following test should be all clear

	bolixo-production test-system

    At this point, you have a running bolixo node, properly registered to bolixo.org.
    Users can create accounts.

Tests
=====

bolixo-production test-system

